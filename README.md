# ソフトウェア品質管理
---
### 試験範囲
- テストプロセス概要, リスク分析
- 1章~9章

様々な概念や技術について説明できるかを問う(5W1H)
## ソフトウェアの品質特性

- 機能性  
    - 合目的性 正確性　接続製　標準適合性　セキュリティ
- 信頼性
    - 成熟性　障害許容性　回復性
    RASIS（定量的評価）
- 使用性
    - 理解性　習得性　運用性
- 効率性
    - 実行効率性　資源効率性

## 品質が良いとは  
- 品質評価は人によって異なる

    - 顧客品質を満たす度合い
    - 顧客要求は非普遍的
    - 顧客要求を満たしていない点 -> 欠陥


### ソフトウェアテストのV字モデル
開発|テスト
--|--
要件|受け入れテスト
上位レベルの設計|システムテスト
詳細設計|結合テスト
コーディング|単体テスト
- todo
    - テストの階層化をどうして行うのか？

## 欠陥防止の意義
- 上流工程の欠陥は発見まで時間がかかり、修復が困難
- 上流工程に１時間かけると、下流工程は3~10時間減る

## レビュー
### 上流工程での欠陥防止
- 文書化
    - 無形のソフトウェアを目に見える形にする
- 文書化することによって欠陥に気づく
- 文書化することによって他者のチェックが可能に
    - 顧客によるチェックが可能

品質を作り込み、テスト段階まで持ち越されるエラーを最小限に抑える

### どんな欠陥を発見するのか
- 要求や仕様、コードやデータの矛盾、不整合、欠落、重複、曖昧さ、わかりにくさ
- 技術面/コスト面/期間面　での実現性のなさ
- 範囲外の要件、仕様、優先順位の観点からのコントロールの欠如
- キャパシティ、パフォーマンスの観点からの問題

### レビューの種類
- ウォークスルー (Walkthrough)
    - 立ち稽古、演技と台詞読みを同時に行う舞台稽古より
    - 仲間うちでの検査の一形態、自主運営
    - テストケースを想定、机上シミュレーション
    - フランクな形で内容の検討
- インスペクション (Inspection)
    - 準備と運営はプロジェクトにおいて任命された、訓練を受けたモデレーターが対応
    - フォーマルなエラーログを取り、修正状況の追跡を行い、再発防止に活用する
---

## 0.1章
- 予防テストとは
    - テストの定義の変化
    - テストに関する見方の変化
- テストプロセス
    - ウォーターホール　V字モデル
    - 開発、テストプロセスの関係
    - 成果物
      - テストウェア
        - テスト分析
        - テスト設計
        - テスト仕様
        - ソフトウェア開発にテストウェア成果物
    - 活動タイミング


- STEP
  - 予防,リスク管理
  - 計画、テスト準備　要件定義間
  - ドキュメント化して可視性を高める


- 計画 リスクの予測と戦略の選択
- 分析 テスト対象事項とテスト要件の設定
- 設計 実行するテスト仕様の設定
- 実行準備 テスト手順およびテストケースの作成
- 実行 テストの実行および再実行
- 保守 ソフトウェアの変更に応じたテストの保存と更新

## 0.2章
- 何件テストするかより、何をテストするかが重要
- リスク分析
  - リスク 何か出来事が発生して否定的な影響を受ける可能性があること
  - 目的、実施者、実施時期、方法の決定
  - 利用可能な材料集め
  - 障害が発生する相対的な可能性の指標を割り当て
    - リスク度 ＝ 障害の可能性 + 障害の影響
    - 不具合、欠陥、バグ
    - 全てをテストできない

### リスク優先度指数

  - 重要度　x　優先度　x　発生確率  
  優先度指数が低いものから対処

- 重要度(システムへの影響)
  1. データの消失、ハードウェアの損傷、または安全上の問題が発生
  2. 機能が失われ、迂回方法がない
  3. 機能が失われるが、迂回方法がある
  4. 機能が部分的に失われる
  5. 表面的または些細な問題


- 優先度（ユーザやクライアントへの影響）
  1. システムの価値が完全に失われる
  2. システムの価値が許容できないほど失われる
  3. システムの価値が低下するが、許容できる可能性がある
  4. システムの価値が低下するが、許容できる
  5. システムの価値の低下は無視できるほどわずかである


- 発生確率
  1. すべてのユーザに必ず影響する
  2. 一部のユーザに影響する可能性が高い
  3. 一部のユーザに影響する可能性がある
  4. 少数のユーザに限定的な影響が生じる
  5. 実際の使用方法では考えられない


- 利用可能な時間とリソースの範囲内で実行可能なテストの量を予測
- リスクが高い機能はそれを低くする方法を検討

リスクへの対応
  - 範囲縮小
  - 納期延長
  - 品質プロセス削減


## 1章
- どんなソフトウェアにもバグは潜む
    - 品質が悪いとは
      - バグにより本来の機能が制限され、ソフトウェアに期待される機能を顧客に提供できない
      - バグ、欠陥、障害、故障、不具合
- テスト担当の心得
    - バグをすべて見つけるのはムリ
    - エラーは見つからないだろうといった仮定はダメ
    - 欠陥を見つけるためのテスト
    - どの部分にバグが出やすいのか、そこにどのようなテスト手法を適用すれば十分な品質が得られるかを知ることが重要
- テストケースを書くことはプログラムを書くことより難しい

## 2章
- ホワイトボックステスト
    - テストケースはプログラムの論理構造に着目したテスト
      - プログラムの仕様の間違いによるバグが発見できない
      - 大規模で複雑な現代のプログラムには向かない
    - ブラックボックステストとの比較
- 制御パステスト
    - 制御パス
      - プログラムが実行される経路　分岐、ループ
    - ステートメントカバレッジ(命令網羅)、ブランチカバレッジ(条件網羅)
    - カバレッジテストの限界
      - 60~90%程度で十分
      - エラー処理や未使用コードはカバーされない
        - ループやマルチタスク関するバグ
        - 仕様書のミス
        - データに関するバグ
          - 再現性やタイミングに依存するバグの発見は難しい
        - 非常にコストがかかる上に欠点も多い
- データフローパステスト
  - プログラム中のデータの状態に焦点
    - 定義、消滅、使用
    - 消滅後、存在しない基状況からの使用
- テスト駆動開発
  - 単体テストのテストケースを作成し、テストコードを書く
  - 対象のプログラムを書く
  - テストに合格するようにする
  - リファクタリング、コード修正
  - テストコードは常に、実行される
- 静的コード解析

- サイクロマチック数
  - C（複雑度）＝e（エッジの数）ー n（ノード数）＋ 2

## ブラックボックステスト
- ブラックボックステストの基本
    - 仕様をもとにテストケース作成
    - 同値分割、境界値分割
    - ホワイトボックステストとのトレードオフ
- 様々なテスト技法
    - デシジョンテーブルテスト
      - 一連のルールによって定義できるシステムを記述
      -  条件の集合とビジネスルールの組み合わせ表
    - 状態遷移テスト
      - 機能および出力が現在の入力だけでなく、過去の入力の影響を受けるようなシステム
      - 各状態を少なくとも1度発生
      - 各遷移を少なくとも1度発生
    - 直交表を用いたテストケース作成
    - その他
        - アドホックテスト
          - 思いついた項目をテスト
        - ランダムテスト
          - 入力データをランダムに
        - 半ランダムテスト
          - 属性の組み合わせをランダムに
        - 探索的テスト
          - テスト設計と実行を並行に
          - テスト結果からより深くテストする部分を見つける
- エラー推測
    - 仮説的推論
      - どのようなバグが発見されたかの傾向を見つける
      - 何に対するバグか？
    - エラーシェーディング (人為的にエラーを埋め込む)

### まとめ
ブラックボックステスト
- 入力ダイアログがあれば境界値テスト
- 複数の入力ダイアログがあればディシジョンテーブルテスト
- ダイアログボックスの遷移があれば状態遷移テスト

## 4章
- テストケースベーステスト
  - テストケース設計、作成（ドキュメント作成)
  - テストリリースに対してテスト実行
  - 繰り返し
- 探索的テスト
  - 1個人のテスト
  - 継続的に実行
  - ソフトウェア機能を学習しながら、設計と実行を同時に
  - 非機能要求のテストには向いていない
- 両者の違い

## 5章
### システムテストとは
  - 機能テストとシステムテストの関係
  - 非機能要求のテスト

- 構成テスト
    - マトリックス網羅
      - テスト漏れ、重複はないか
    - 異なるシステム構成でテスト


- 負荷テスト
  - 高負荷をかけてみる


- 性能テスト
  - 既定の性能が出るか？
  - パフォーマンスの定義を明確に
  - 後回しにしない


- ユーザビリティテスト
  - 使いやすさを実際に使ってもらってテスト
  - アクセシビリティ・学習性・効率性・操作性
  - テスト担当や開発者は行わない


- セキュリティテスト
    - 気密性・完全性・可用性


### 脆弱性
  - バッファオーバーフロー、フォーマットバグ、XSS、クエリインジェクション
  - 意図しない方法で攻撃者にコードを実行させるのを防ぐ


- セキュリティ機能テスト
    - プログラムレベルで脆弱性を検出
    - コードレビュー、人力テスト、モジュール指向テスト


- セキュリティシステムテスト
    - 実際の攻撃の種類に合わせたテストパターンを作成
    - システムレベルで攻撃耐性をテスト
    - 攻撃に対して、解析・変更・監視


- スモークテスト
    - ビルドできてる？テスト耐えれる？
    - 短時間で広い機能の範囲を対象にする


- 回帰テスト
  - ソフトウェアの修正に伴って実行
    - サイドエフェクトバグ
    - デグレード
    - 回帰テストの自動化


- 信頼度成長曲線
  - m(t)=a(1-e^{-bt})
  - a バグ総数、　b バグ発見率


## 6章
### ソフトウェアテスト運用の基本
### コストと品質
- テスト計画書
  - テストケースID
  - テストケーススタイル
  - 実行ステップ
  - 結果
- テストケースの作成と管理
  - テストケースの均一性の確保
- テストケース実行
    - テストログ、不具合レポート
      - 日付
      - 結果
      - 実施者
      - ビルド番号
      - 環境
    - バグトラッキングシステム
      - バグの可視化
      - 大人しくツールを買え

### テスト開始のタイミング
  - 分析、設計のバグが多い
  - 早期にバグを発見することでコスト低減
  - バグの発生から発見までが短いほうがテストの有効性が高い
    - バグの発見が後になればなるほど、その害が大きくなり、修正コストが高くなる

- 欠陥密度=欠陥の数 / コードのステップ数
  - パレート分析／パレート図  
  構成要素の大きい順に並べた棒グラフと累積両を示す折れ線グラフ


- 不具合
  - テストを実行中に発生した異常な結果
- 障害
  - 不具合と同じ意味
- 欠陥(バグ)
  - 障害を引き起こす可能性のあるソフトウェア中の不備
  - コード内とは限らない

- テスト終了の判定
  - 例
    - 残存バグ件数0.5%以内
    - テストケース成功率99%
    - 長時間テストでハングアップ発生せず
  - 直前のバグ
    - 修正せず出荷
    - 出荷延期、修正後に回帰テスト

### テストプロセスの改善
- 改善のためのモデル
    - ISO90000
      - 仕組みの規格
      - PCDAサイクルを回し続けろ
      - プロセス改善のツールとしての認証
    - 能力成熟度
    - CMM成熟度レベル
      1. 初期レベル　プロセス未定義・場当たり的
      2. 反復できるレベル 基本的なプロジェクト管理の実施
      3. 定義されたレベル 管理と開発プロセスの定義、統合。プロセスの文章化
      4. 管理されたレベル 得られたデータに基づいたプロセスとプロダクトの理解、制御
      5. 最適化するレベル プロセスからフィードバックと革新的技術の志向による持続的な改善
        - 担当者や顧客に合わせてない
        - 範囲が広すぎる
    - テストプロセス改善(TPI)
      - CMMレベル3を目指す
      - テストに関係する領域に対して[A,B,C,D]の4段階表現
- 利点と欠点
- TPIモデル
    - チェックポイントを用いて主要領域の成熟度レベルを決定
    - 依存関係チャートを参考に、次に目標とするレベル決定
    - 目標とするレベルを達成するためのチェックポイントと改善提案を参考に改善計画の立案実行
- 継続的な改善
  - プロセス改善モデルの選択(CMM,ISO,TPI)
  - 改善を行わないと退化する
    - PCDA

## 7章
### メトリクスとは

- 品質の可視化
- バグメトリクス
  - 発見されるバグ（欠陥）の数  
  - バグのライフサイクル
  - バグの数、修正時間


- コードカバレッジメトリクス
    - 文カバレッジ、分岐カバレッジ
      - カバレッジモニタツールの使用
    - 設計カバレッジ
      - 設計すべきテスト項目をどれだけ設計したか
    - 実行カバレッジ
      - 実行すべきテスト項目をどれだけ実行したか


- ソースコードメトリクス
    - LOC(行数)、バグ密度
      - 1000行あたりバグが2つ以内　よい


- 複雑度メトリクス
    - サイクロマチック数
      - 1-10 シンプル　バグのリスク少
      - 11-20 多少複雑 バグのリスクが存在
      - 21-50 複雑 リスクが高い
      - 50↑ 管理もテストもムリ クソ

- 人の能力や個人の仕事の結果を測るな
- プロジェクトや品質を客観視
- それでも万能じゃない
  - 複数のメトリクスを組み合わせてよしなにして


## 8章
### テスト自動化の功罪
  - 自動化した方がコストが下がる作業と手動でした方がコストがかからない作業がある
    - 自動化のコスト

- テスト自動化の鉄則
    - 自動化に向くテスト
        - スモークテスト、パフォーマンステスト、APIテスト
    - 自動化に向かないテスト
        - 回帰テスト
        - グラフィック、サウンドなどメディア関係テスト


- テスト自動化の本当の問題点
  - 戦略なく自動化するな
  - 期待が大きすぎる
  - 保守不可能なコードを書くな
  - 誤ったツールを使うな

## 9章
- 組み合わせテストやめろ
- グローバル変数使うな
- マルチプロセスでデータの共有するのやめろ
- 80%のバグは20%のコンポーネントに
  - 低品質の箇所を徹底的に叩く
  - プロジェクト開始からのバグの発見数の記録から判断
-  バグ予測で楽しようね

---
# 質疑応答
- ブラックボックステストを補うものとしてのホワイトボックステスト
- 内部構造よりも出力結果が重要
    - 保守性(変更が容易であるか)は落ちる
    - 機能拡張の要求が来てもなにもできない
        - クソ
        - リファクタリングでなんとかしろ
